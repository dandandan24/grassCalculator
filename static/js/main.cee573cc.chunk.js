(this.webpackJsonpgrass_calculator=this.webpackJsonpgrass_calculator||[]).push([[0],{178:function(t,e,n){},179:function(t,e,n){},292:function(t,e,n){"use strict";n.r(e);var o=n(0),a=n.n(o),r=n(20),i=n.n(r),c=(n(178),n(179),n(8)),s=n(16),l=n(349),h=n(350),u=n(360),g=n(355),j=n(362),d=n(163),p=n.n(d),b=n(356),x=n(6),f=n(53),O=n(361),y=n(342),m=n(358),v=n(352),P=n(343),M=n(347),k=n(346),w=n(338),S=n(344),C=n(345),F=n(1),R=function(t){return Object(F.jsx)(w.a,{component:y.a,children:Object(F.jsxs)(P.a,{children:[Object(F.jsx)(S.a,{children:Object(F.jsxs)(C.a,{children:[Object(F.jsx)(k.a,{align:"right",children:"\u05e8\u05d5\u05d7\u05d1 : 2 \u05de\u05d8\u05e8\u05d9\u05dd"}),Object(F.jsx)(k.a,{align:"right",children:"\u05e8\u05d5\u05d7\u05d1 : 3 \u05de\u05d8\u05e8\u05d9\u05dd"}),Object(F.jsx)(k.a,{align:"right",children:"\u05e8\u05d5\u05d7\u05d1 : 4 \u05de\u05d8\u05e8\u05d9\u05dd"}),Object(F.jsx)(k.a,{align:"right",children:'\u05e1\u05d4"\u05db \u05e9\u05d8\u05d7'}),Object(F.jsx)(k.a,{align:"right",children:'\u05e1\u05d4"\u05db \u05e4\u05d7\u05ea'})]})}),Object(F.jsx)(M.a,{children:Object(F.jsxs)(C.a,{children:[Object(F.jsx)(k.a,{align:"right",children:t.row?t.row.TwoMeter:"0"}),Object(F.jsx)(k.a,{align:"right",children:t.row?t.row.ThreeMeter:"0"}),Object(F.jsx)(k.a,{align:"right",children:t.row?t.row.FourMeter:"0"}),Object(F.jsx)(k.a,{align:"right",children:t.row?Math.floor(t.row.TotalArea)+' \u05de"\u05e8':"0 "}),Object(F.jsx)(k.a,{align:"right",children:t.row?t.row.LeftOvers+' \u05de"\u05e8':"0"})]})})]})})},A=n(348),W=(n.p,n(29)),T=n(7),D=function(t){var e=t.shapeProps,n=t.isSelected,r=t.onSelect,i=t.onChange,c=Object(o.useRef)(),s=Object(o.useRef)();return Object(o.useEffect)((function(){n&&(s.current.nodes([c.current]),s.current.getLayer().batchDraw())}),[n]),Object(F.jsxs)(a.a.Fragment,{children:[Object(F.jsx)(T.e,Object(x.a)(Object(x.a)({onClick:r,onTap:r,ref:c},e),{},{draggable:!0,onDragEnd:function(t){i(Object(x.a)(Object(x.a)({},e),{},{x:t.target.x(),y:t.target.y()}))},onTransform:function(t){var n=c.current,o=n.scaleX(),a=n.scaleY();n.scaleX(1),n.scaleY(1),i(Object(x.a)(Object(x.a)({},e),{},{x:n.x(),y:n.y(),width:Math.max(5,n.width()*o),height:Math.max(n.height()*a)}))},onTransformEnd:function(t){var n=c.current,o=n.scaleX(),a=n.scaleY();n.scaleX(1),n.scaleY(1),i(Object(x.a)(Object(x.a)({},e),{},{x:n.x(),y:n.y(),width:Math.max(5,n.width()*o),height:Math.max(n.height()*a)}))}})),n&&Object(F.jsx)(T.i,{ref:s,boundBoxFunc:function(t,e){return e.width<5||e.height<5?t:e}})]})},U=(n(105),Object(W.b)((function(t){return{proportion:t.konva.proportion,accuracy:t.konva.accuracy}}),(function(t){return{}}))((function(t){var e=Object(o.useState)([]),n=Object(s.a)(e,2),a=n[0],r=n[1],i=Object(o.useState)([0,0]),l=Object(s.a)(i,2),h=l[0],u=l[1],g=Object(o.useState)(!1),j=Object(s.a)(g,2),d=j[0],p=j[1],b=Object(o.useState)(!1),f=Object(s.a)(b,2),O=f[0],y=f[1],m=function(){return t.stage?[t.stage.getPointerPosition().x,t.stage.getPointerPosition().y]:0},v=function(t){O||a.length<3||(t.target.scale({x:2,y:2}),p(!0))},P=function(t){t.target.scale({x:1,y:1}),p(!1)},M=function(t){console.log("start",t)},k=function(t){var e=e,n=t.target.index-1;console.log(t.target);var o=[t.target.attrs.x,t.target.attrs.y];console.log("move",t),console.log(o,"pos"),r([].concat(Object(c.a)(e.slice(0,n)),[o],Object(c.a)(e.slice(n+1))))},w=function(){console.log("not defined function")},S=a.concat(O?[]:h).reduce((function(t,e){return t.concat(e)}),[]);return Object(F.jsx)(T.g,{onMouseDown:function(e){console.log("handling click");t.stage;var n=m();O||(d&&a.length>=3?y(!0):r([].concat(Object(c.a)(a),[n])))},onMouseMove:function(e){t.stage;var n=m();u(n)},children:Object(F.jsxs)(T.c,{children:[Object(F.jsx)(T.d,{points:S,stroke:"black",strokeWidth:5,closed:O}),a.map((function(t,e){var n=t[0]-3,o=t[1]-3,a=0===e?{hitStrokeWidth:12,onMouseOver:v,onMouseOut:P}:null;return Object(F.jsx)(T.e,Object(x.a)({x:n,y:o,width:6,height:6,fill:"white",stroke:"black",strokeWidth:3,onDragStart:M,onDragMove:k,onDragEnd:w,draggable:!0},a),e)}))]})})})),function(t){var e=t.shapeProps,n=t.isSelected,r=t.onSelect,i=t.onChange,c=Object(o.useRef)(),s=Object(o.useRef)();return Object(o.useEffect)((function(){n&&(s.current.nodes([c.current]),s.current.getLayer().batchDraw())}),[n]),Object(F.jsxs)(a.a.Fragment,{children:[Object(F.jsx)(T.b,Object(x.a)(Object(x.a)({onClick:r,onTap:r,ref:c},e),{},{draggable:!0,onTransform:function(t){var n=c.current,o=n.scaleX(),a=n.scaleY();n.scaleX(1),n.scaleY(1),i(Object(x.a)(Object(x.a)({},e),{},{x:n.x(),y:n.y(),width:Math.max(5,n.width()*o),height:Math.max(n.height()*a),radius:Math.max(5,n.width()*o)}))},onDragMove:function(t){i(Object(x.a)(Object(x.a)({},e),{},{x:t.target.x(),y:t.target.y()}))},onDragEnd:function(t){i(Object(x.a)(Object(x.a)({},e),{},{x:t.target.x(),y:t.target.y()}))},onTransformEnd:function(t){var n=c.current,o=n.scaleX(),a=n.scaleY();n.scaleX(1),n.scaleY(1),i(Object(x.a)(Object(x.a)({},e),{},{x:n.x(),y:n.y(),width:Math.max(5,n.width()*o),height:Math.max(n.height()*a),radius:Math.max(5,n.width()*o)}))}})),n&&Object(F.jsx)(T.i,{enabledAnchors:["top-left","top-right","bottom-right","bottom-left"],ref:s,boundBoxFunc:function(t,e){return e.width<5||e.height<5?t:e}})]})}),z=n(351),E=n(157),H=n.n(E),I=(n(223),Object(A.a)((function(t){var e;return{root:(e={},Object(f.a)(e,t.breakpoints.down("sm"),{width:"100%"}),Object(f.a)(e,t.breakpoints.up("sm"),{width:"100%"}),Object(f.a)(e,t.breakpoints.up("md"),{width:"100%"}),Object(f.a)(e,t.breakpoints.up("xl"),{width:"80%"}),e)}}))),L=Object(W.b)((function(t){return{Polygons:t.konva.Polygons,height:t.konva.height,Rectangles:t.konva.Rectangles,Circles:t.konva.Circles,mode:t.konva.mode,Windowstage:t.konva.Windowstage,AlgorithmResult:t.konva.AlgorithmResult,proportion:t.konva.proportion}}),(function(t){return{ChangeMode:function(e){return t({type:"ChangeMode",newMode:e})},ChangeStageWindow:function(e){return t({type:"ChangeStageWindow",newWindowstage:e})},UpdateCircles:function(e){return t({type:"UpdateCircles",newCircles:e})},UpdatePolygons:function(e){return t({type:"UpdatePolygons",newPolygons:e})},UpdateRectangles:function(e){return t({type:"UpdateRectangles",newCircles:e})}}}))((function(t){var e=I(),n=Object(o.useState)(0),r=Object(s.a)(n,2),i=r[0],c=r[1],u=Object(o.useState)(document.getElementById("parentWindow")),g=Object(s.a)(u,2),j=g[0],d=g[1],p=Object(o.useState)(0),b=Object(s.a)(p,2),f=b[0],P=b[1];Object(o.useEffect)((function(){d(document.getElementById("parentWindow"))})),Object(o.useEffect)((function(){}),[t.Polygons,t.Rectangles,t.Circles]);for(var M=function(t){for(var e=[],n=0;n<t.length-2;n++)e.push(t[n]);return e.push(t[0]),e.push(t[1]),e},k=function(t,e,n,o){return Math.sqrt(Math.pow(Math.abs(o-e),2)+Math.pow(Math.abs(n-t),2))},w=function(t){var e=t;return"("+(e[0]>0?"2X"+e[0].toString()+",":"")+(e[1]>0?"3X"+e[1].toString()+",":"")+(e[2]>0?"4X"+e[2].toString()+",":"")+")"},S=j?j.offsetWidth/60:0,C=[],A=0;A<S;A++)C.push(A);var W=30/t.proportion*2,E=[[0,0,0],0],L=0;return t.AlgorithmResult[i]&&(E=function(){for(var e=[0,0,0],n=0,o=0;o<t.AlgorithmResult[i].length;o++)for(var a=0;a<t.AlgorithmResult[i][o].length;a++)e[0]+=t.AlgorithmResult[i][o][a][0][0],e[1]+=t.AlgorithmResult[i][o][a][0][1],e[2]+=t.AlgorithmResult[i][o][a][0][2],n+=t.AlgorithmResult[i][o][a][1];return[e,n]}()),t.AlgorithmResult[i]&&(L=function(){for(var e=0,n=[0,0,0],o=0;o<t.AlgorithmResult[i].length;o++)for(var a=0;a<t.AlgorithmResult[i][o].length;a++)n[0]+=t.AlgorithmResult[i][o][a][0][0],n[1]+=t.AlgorithmResult[i][o][a][0][1],n[2]+=t.AlgorithmResult[i][o][a][0][2],e+=2*n[0]*t.AlgorithmResult[i][o][a][7],e+=3*n[1]*t.AlgorithmResult[i][o][a][7],e+=4*n[2]*t.AlgorithmResult[i][o][a][7],n=[0,0,0];return e}()),Object(F.jsx)(O.a,{fullScreen:!0,maxWidth:"xl",onClose:t.close,open:t.open,children:Object(F.jsxs)(l.a,{container:!0,spacing:0,style:{direction:"rtl"},direction:"row",children:[Object(F.jsxs)(l.a,{item:!0,xl:3,xs:3,children:[Object(F.jsx)("p",{style:{direction:"rtl",fontSize:"24px",marginRight:"20px"},children:"\u05d7\u05d9\u05e9\u05d5\u05d1 \u05d4\u05d6\u05de\u05e0\u05ea\u05db\u05dd"}),Object(F.jsx)(h.a,{variant:"middle",style:{width:"15%",position:"absolute",right:"0",marginTop:"-20px"}})]}),Object(F.jsx)(l.a,{item:!0,xs:8}),Object(F.jsx)(l.a,{item:!0,xs:1,style:{marginTop:"20px"},children:Object(F.jsxs)(z.a,{style:{textTransform:"none",color:"#AFD5AA"},onClick:t.close,children:["Back To Editing",Object(F.jsx)(H.a,{})]})}),Object(F.jsx)(l.a,{item:!0,xl:6,xs:6,style:{marginRight:"20px"},children:Object(F.jsx)(y.a,{className:e.root,children:Object(F.jsxs)(m.a,{value:i,indicatorColor:"primary",textColor:"primary",onChange:function(t,e){c(e)},children:[Object(F.jsx)(v.a,{label:"\u05de\u05d9\u05e0\u05d9\u05de\u05d5\u05dd \u05e4\u05d7\u05ea"}),Object(F.jsx)(v.a,{label:"\u05de\u05d9\u05e0\u05d9\u05de\u05d5\u05dd \u05d7\u05d9\u05d1\u05d5\u05e8\u05d9\u05dd"}),Object(F.jsx)(v.a,{label:"\u05de\u05d9\u05e0\u05d9\u05de\u05d5\u05dd \u05e4\u05d7\u05ea + \u05db\u05d9\u05d5\u05d5\u05df \u05e1\u05d9\u05d1 \u05d0\u05d7\u05d9\u05d3"}),Object(F.jsx)(v.a,{label:"\u05de\u05d9\u05e0\u05d9\u05de\u05d5\u05dd \u05d7\u05d9\u05d1\u05d5\u05e8\u05d9\u05dd + \u05db\u05d9\u05d5\u05d5\u05df \u05e1\u05d9\u05d1 \u05d0\u05d7\u05d9\u05d3"})]})})}),Object(F.jsx)(l.a,{item:!0,xl:3,xs:3,style:{marginRight:"20px"},children:Object(F.jsx)(y.a,{className:e.root,children:Object(F.jsxs)(m.a,{value:f,indicatorColor:"primary",textColor:"primary",onChange:function(t,e){P(e)},children:[Object(F.jsx)(v.a,{label:"\u05ea\u05d5\u05e6\u05d0\u05d4"}),Object(F.jsx)(v.a,{label:"\u05e9\u05e8\u05d8\u05d5\u05d8 \u05d4\u05ea\u05d7\u05dc\u05ea\u05d9"})]})})}),Object(F.jsxs)(l.a,{item:!0,xl:6,xs:6,style:{marginTop:"0px"},children:[Object(F.jsx)("p",{style:{direction:"rtl",fontSize:"20px",marginRight:"20px"},children:"\u05d2\u05dc\u05d9\u05dc\u05d9\u05dd \u05d3\u05e8\u05d5\u05e9\u05d9\u05dd"}),Object(F.jsx)(h.a,{variant:"middle",style:{width:"6%",position:"absolute",right:"0",marginTop:"-15px",marginRight:"20px"}})]}),Object(F.jsx)(l.a,{item:!0,xl:6,xs:6,style:{marginRight:"20px"},children:Object(F.jsx)(R,{row:{TwoMeter:E[0][0],ThreeMeter:E[0][1],FourMeter:E[0][2],TotalArea:L,LeftOvers:E[1].toFixed(2)}})}),Object(F.jsx)(l.a,{item:!0,xl:12,xs:12,children:Object(F.jsx)("div",{id:"parentWindow",style:{border:"2px grey solid",marginTop:"20px",borderRadius:"10px",height:"56vh",width:"97vw",marginRight:"20px"},children:Object(F.jsxs)(T.g,{ref:function(e){e&&(e,t.ChangeStageWindow(e))},width:j?j.offsetWidth:0,height:j?j.offsetHeight:0,children:[Object(F.jsxs)(T.c,{children:[j?[0,1,2,3,4,5,6,7,8,9,10].map((function(t){return Object(F.jsx)(a.a.Fragment,{children:Object(F.jsx)(T.d,{points:[0,60*t,j.offsetWidth,60*t],strokeWidth:2,stroke:"lightgrey"})})})):Object(F.jsx)(F.Fragment,{}),j?C.map((function(t){return Object(F.jsx)(a.a.Fragment,{children:Object(F.jsx)(T.d,{points:[j.offsetWidth/S*t,0,j.offsetWidth/S*t,j.offsetHeight],strokeWidth:2,stroke:"lightgrey"})})})):Object(F.jsx)(F.Fragment,{})]}),Object(F.jsxs)(T.c,{children:[t.Rectangles.map((function(e,n){return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(D,{shapeProps:Object(x.a)(Object(x.a)({},e),{},{x:e.x,width:e.width,height:e.height,stroke:0===f?"":"black",fill:0===f?"#AFD5AA":""})},n),1===f?Object(F.jsxs)(F.Fragment,{children:[t.Rectangles.map((function(t,e){return Object(F.jsx)(T.h,{text:Math.floor(Math.abs(t.width))/W,x:t.xDirection=t.x+t.width/2,y:t.y,fontSize:20})})),t.Rectangles.map((function(t,e){return Object(F.jsx)(T.h,{text:Math.floor(Math.abs(t.height))/W,x:t.x,y:t.xDirection=t.y+t.height/2,fontSize:20})}))]}):Object(F.jsx)(F.Fragment,{})]})})),t.Circles.map((function(t,e){return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(U,{shapeProps:Object(x.a)(Object(x.a)({},t),{},{x:t.x,radius:t.radius,width:t.width,height:t.height,fill:0===f?"#AFD5AA":"",stroke:0===f?"":"black"})},e),1===f?Object(F.jsx)(T.h,{text:Math.floor(t.radius)/W/2,x:t.x,y:t.y,fontSize:t.radius<20?15:20}):Object(F.jsx)(F.Fragment,{})]})})),t.Polygons.map((function(t,e){return Object(F.jsxs)(F.Fragment,{children:[t.anchorPoints.map((function(e,n){return Object(F.jsx)(F.Fragment,{children:Object(F.jsx)(T.f,{sceneFunc:function(o,a){o.beginPath(),t.points[n]&&t.points[n+1]?(o.moveTo(t.points[n][0],t.points[n][1]),o.quadraticCurveTo(e[0],e[1],t.points[n+1][0],t.points[n+1][1])):n===t.points.length-1&&(o.moveTo(t.points[n][0],t.points[n][1]),o.quadraticCurveTo(e[0],e[1],t.points[0][0],t.points[0][1])),o.fillStrokeShape(a)},stroke:0===f?"":"black",strokeWidth:4})})})),t.flattenedPoints.map((function(e,n){var o=-500,a=-500,r=t.flattenedPoints[n+2],i=t.flattenedPoints[n+3];return n%2===0&&n+3<t.flattenedPoints.length&&(o=(e+t.flattenedPoints[n+2])/2,a=(t.flattenedPoints[n+1]+t.flattenedPoints[n+3])/2),1===f&&n%2===0?Object(F.jsx)(T.h,{text:(parseFloat(k(o,a,r,i))/W*2).toFixed(2),x:o,y:a,fontSize:20}):Object(F.jsx)(F.Fragment,{})}))]})})),t.Polygons.map((function(t,e){return Object(F.jsx)(T.d,{closed:!0,points:M(t.flattenedPoints),strokeWidth:4,fill:0===f?"#AFD5AA":""})}))]}),0===f?Object(F.jsx)(T.c,{children:t.AlgorithmResult[i]?t.AlgorithmResult[i].map((function(e,n){return e.map((function(e,n){console.log(e,"rect in result");var o=Math.abs(e[3][0][0]-e[3][1][0]),a=e[5],r=e[2],i=Math.abs(e[3][0][1]-e[3][2][1]),c=(o+(r!==o?a:0))*W,s=(i+(r!==i?a:0))*W,l=e[3][0][0]*W,h=t.height-e[3][0][1]*W;return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(D,{shapeProps:{x:e[3][0][0]*W,y:t.height-e[3][0][1]*W,width:(o+(r!==o?a:0))*W,height:(i+(r!==i?a:0))*W,stroke:"grey",dash:[10,10],strokeWidth:3}},n),Object(F.jsx)(T.h,{text:parseFloat(o+(r!==o?a:0)).toFixed(2),x:e[3][0][0]*W+(o+(r!==o?a:0))*W/2,y:t.height-e[3][0][1]*W-30+(i+(r!==i?a:0))*W/2,fontSize:20}),Object(F.jsx)(T.h,{text:parseFloat(i+(r!==i?a:0)).toFixed(2),x:e[3][0][0]*W-30+((o+(r!==o?a:0))*W/2-30),y:t.height-e[3][0][1]*W+(i+(r!==i?a:0))*W/2,fontSize:20}),r===o?Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(T.h,{text:"("+e[7].toString()+")",x:e[3][0][0]*W+(o+(r!==o?a:0))*W/2+40,y:t.height-e[3][0][1]*W-25+(i+(r!==i?a:0))*W/2,fontSize:12}),Object(F.jsx)(T.h,{text:w(e[0]),x:e[3][0][0]*W-10+((o+(r!==o?a:0))*W/2-70),y:t.height-e[3][0][1]*W+(i+(r!==i?a:0))*W/2+20,fontSize:12})]}):Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(T.h,{text:"("+e[7].toString()+")",x:e[3][0][0]*W-10+((o+(r!==o?a:0))*W/2-30),y:t.height-e[3][0][1]*W+(i+(r!==i?a:0))*W/2+20,fontSize:12}),Object(F.jsx)(T.h,{text:w(e[0]),x:e[3][0][0]*W+(o+(r!==o?a:0))*W/2+40,y:t.height-e[3][0][1]*W-12+(i+(r!==i?a:0))*W/2,fontSize:12})]}),Object(F.jsx)(T.a,{points:"right"===e[6]?[l+c/2,h+s/2,l+c/2+30,h+s/2]:[l+c/2,h+s/2,l+c/2,h+s/2+30],stroke:"black",strokeWidth:"black",fill:"black"})]})}))})):Object(F.jsx)(F.Fragment,{})}):Object(F.jsx)(F.Fragment,{})]})})})]})})})),B=n(353),q=n(363),X=n(126),Y=n.n(X),N=n(161),_=n.n(N),V=n(160),J=n.n(V),G=n(159),K=n.n(G),Q=n(158),Z=n.n(Q),$=n(357),tt=n(364),et=n(354),nt=Object(W.b)((function(t){return{mode:t.konva.mode,proportion:t.konva.proportion,accuracy:t.konva.accuracy}}),(function(t){return{ChangeMode:function(e){return t({type:"ChangeMode",newMode:e})},Undo:function(){return t({type:"Undo"})},Reset:function(){return t({type:"Reset"})},ChangeProportion:function(e){return t({type:"ChangeProportion",newProportion:e})},ChangeAccuracy:function(e){return t({type:"ChangeAccuracy",newAccuracy:e})}}}))((function(t){return Object(F.jsxs)(l.a,{container:!0,direction:"row",style:{height:"100%",width:"100%"},children:[Object(F.jsx)(l.a,{item:!0,xl:1,md:0,style:{marginRight:"1vw"}}),Object(F.jsx)(l.a,{item:!0,xs:1,style:{alignItems:"center",marginTop:"1vh"},children:Object(F.jsx)(z.a,{onClick:t.Reset,style:{boxShadow:"2px 2px 2px 2px grey",border:"2px solid grey"},children:Object(F.jsx)(Z.a,{})})}),Object(F.jsx)(l.a,{item:!0,xs:1,style:{alignItems:"right",marginTop:"1vh"},children:Object(F.jsx)("p",{style:{marginRight:"-2vw"},children:"Reset"})}),Object(F.jsx)(l.a,{item:!0,xs:1,style:{alignItems:"center",marginTop:"1vh"},children:Object(F.jsx)(z.a,{onClick:t.Undo,style:{margin:"0px",boxShadow:"2px 2px 2px 2px grey",border:"2px solid grey"},children:Object(F.jsx)(K.a,{})})}),Object(F.jsx)(l.a,{item:!0,xs:1,style:{alignItems:"right",marginTop:"1vh"},children:Object(F.jsx)("p",{style:{marginRight:"-2vw"},children:"Undo"})}),Object(F.jsx)(l.a,{item:!0,xl:2,xs:3,style:{alignItems:"center",width:"50%"},children:Object(F.jsxs)(q.a,{size:"large",value:t.mode,exclusive:!0,onChange:function(e,n){t.ChangeMode(n)},style:{marginTop:"1vh",boxShadow:"2px 2px 2px 2px grey"},children:[Object(F.jsx)(B.a,{value:"Rect",children:Object(F.jsx)(J.a,{})}),Object(F.jsx)(B.a,{value:"Polygon",children:Object(F.jsx)(_.a,{})}),Object(F.jsx)(B.a,{value:"Circle",children:Object(F.jsx)(Y.a,{})}),Object(F.jsx)(B.a,{value:"Ellipse",children:Object(F.jsx)(Y.a,{})})]})}),Object(F.jsx)(l.a,{item:!0,xs:2,children:Object(F.jsx)($.a,{style:{marginTop:"1vh",width:"12vw",direction:"rtl"},id:"standard-number",label:"proportion (meter per square)",type:"number",defaultValue:1,value:t.proportion,onChange:function(e){t.ChangeProportion(e.target.value)},InputLabelProps:{shrink:!0},variant:"outlined"})}),Object(F.jsxs)(l.a,{item:!0,xs:2,children:[Object(F.jsx)(et.a,{style:{marginTop:"1vh",marginBottom:"-10px"},id:"discrete-slider",gutterBottom:!0,children:"\u05e8\u05de\u05ea \u05d3\u05d9\u05d5\u05e7 (\u05de\u05e8\u05d7\u05e7 \u05db\u05dc \u05e7\u05e4\u05d9\u05e6\u05d4 \u05d1\u05e1\u05e0\u05d8\u05d9\u05de\u05d8\u05e8)"}),Object(F.jsx)(tt.a,{defaultValue:10,getAriaValueText:function(t){!function(t){"".concat(t,"CM")}(t)},onChange:function(e,n){t.ChangeAccuracy(n)},"aria-labelledby":"discrete-slider",valueLabelDisplay:"auto",step:10,marks:!0,min:10,max:100})]})]})})),ot=n(94),at=n(95),rt=n(74),it=n(165),ct=n(164),st=(o.Component,n(284),Object(W.b)((function(t){return{mode:t.konva.mode,stage:t.konva.stage,stateStack:t.konva.stateStack,Polygons:t.konva.Polygons,Rectangles:t.konva.Rectangles,Circles:t.konva.Circles,points:t.konva.points,proportion:t.konva.proportion,accuracy:t.konva.accuracy}}),(function(t){return{ChangeHeight:function(e){return t({type:"ChangeHeight",newHeight:e})},ChangeMode:function(e){return t({type:"ChangeMode",newMode:e})},ChangeStage:function(e){return t({type:"ChangeStage",newStage:e})},UpdateCircles:function(e){return t({type:"UpdateCircles",newCircles:e})},UpdatePolygons:function(e){return t({type:"UpdatePolygons",newPolygons:e})},UpdateRectangles:function(e){return t({type:"UpdateRectangles",newRectangles:e})},actionTrigger:function(){return t({type:"actionTrigger"})},AddPoint:function(e){return t({type:"AddPoint",newPoint:e})},emptyPoints:function(){return t({type:"emptyPoints"})},Undo:function(){return t({type:"Undo"})}}}))((function(t){var e=null,n=Object(o.useState)(document.getElementById("parent")),r=Object(s.a)(n,2),i=r[0],h=r[1],u=Object(o.useState)(null),g=Object(s.a)(u,2),j=g[0],d=g[1],p=Object(o.useState)(null),b=Object(s.a)(p,2),f=b[0],O=b[1],y=Object(o.useState)("black"),m=Object(s.a)(y,2),v=m[0],P=(m[1],Object(o.useState)([])),M=Object(s.a)(P,2),k=M[0],w=M[1],S=Object(o.useState)(null),C=Object(s.a)(S,2),R=C[0],A=C[1],W=Object(o.useState)([]),z=Object(s.a)(W,2),E=(z[0],z[1],Object(o.useState)([])),H=Object(s.a)(E,2),I=(H[0],H[1],Object(o.useState)([0,0])),L=Object(s.a)(I,2),B=L[0],q=L[1],X=Object(o.useState)(!1),Y=Object(s.a)(X,2),N=Y[0],_=Y[1],V=Object(o.useState)(!1),J=Object(s.a)(V,2),G=J[0],K=J[1],Q=Object(o.useState)(0),Z=Object(s.a)(Q,2),$=Z[0],tt=Z[1],et=Object(o.useState)(null),nt=Object(s.a)(et,2),ot=nt[0],at=nt[1],rt=Object(o.useState)(null),it=Object(s.a)(rt,2),ct=it[0],st=it[1],lt=Object(o.useState)(null),ht=Object(s.a)(lt,2),ut=ht[0],gt=ht[1],jt=Object(o.useState)([30,60]),dt=Object(s.a)(jt,2),pt=dt[0],bt=(dt[1],Object(o.useState)([60,120])),xt=Object(s.a)(bt,2),ft=xt[0],Ot=(xt[1],Object(o.useState)([45,90])),yt=Object(s.a)(Ot,2),mt=yt[0],vt=(yt[1],Object(o.useState)([{x:pt[0],y:pt[1],radius:5,id:1,stroke:"black",fill:"grey"},{x:mt[0],y:mt[1],radius:5,id:3,stroke:"black",fill:"grey"},{x:ft[0],y:ft[1],radius:5,id:2,stroke:"black",fill:"grey"}])),Pt=Object(s.a)(vt,2),Mt=(Pt[0],Pt[1],Object(o.useState)(0)),kt=Object(s.a)(Mt,2),wt=kt[0],St=kt[1],Ct=30,Ft=Ct/t.proportion;Object(o.useEffect)((function(){h(document.getElementById("parent")),t.ChangeHeight(document.getElementById("parent").offsetHeight)}),[]);var Rt=function(){return t.stage?[t.stage.getPointerPosition().x,t.stage.getPointerPosition().y]:0},At=function(e){G||t.points.length<3||(e.target.scale({x:2,y:2}),_(!0))},Wt=function(t){t.target.scale({x:1,y:1}),_(!1)},Tt=function(e){for(var n=[e.target.attrs.x,e.target.attrs.y],o=0;o<t.Polygons.length;o++){for(var a=0;a<t.Polygons[o].points.length;a++)-3<=n[0]-t.Polygons[o].points[a][0]&&n[0]-t.Polygons[o].points[a][0]<=3&&-3<=n[1]-t.Polygons[o].points[a][1]&&n[1]-t.Polygons[o].points[a][1]<=3&&(tt(o),at(a));for(var r=0;r<t.Polygons[o].anchorPoints.length;r++)-3<=n[0]-t.Polygons[o].anchorPoints[r][0]&&n[0]-t.Polygons[o].anchorPoints[r][0]<=3&&-3<=n[1]-t.Polygons[o].anchorPoints[r][1]&&n[1]-t.Polygons[o].anchorPoints[r][1]<=3&&(tt(o),St(r))}},Dt=function(e){if(null!==ot){var n=[e.target.attrs.x,e.target.attrs.y],o=t.Polygons[$].flattenedPoints,a=t.Polygons[$].points;e.target.index;a[ot]=n,o[2*ot]=n[0],o[2*ot+1]=n[1],0===ot&&(o[t.Polygons[$].flattenedPoints.length-2]=n[0],o[t.Polygons[$].flattenedPoints.length-1]=n[1]);var r=[];o.map((function(e,n){n%2===0&&n<o.length-3&&(!1===t.Polygons[$].anchorPoints[n/2][2]&&(r=[].concat(Object(c.a)(r),[[(o[n]+o[n+2])/2,(o[n+1]+o[n+3])/2,!1]])),!0===t.Polygons[$].anchorPoints[n/2][2]&&(r=[].concat(Object(c.a)(r),[[].concat(Object(c.a)(t.Polygons[$].anchorPoints[n/2]),[!0])])))}));var i=Object(c.a)(t.Polygons);i[$].flattenedPoints=o,i[$].points=a,i[$].anchorPoints=r,t.UpdatePolygons(i)}else{var s=[e.target.attrs.x,e.target.attrs.y,!0],l=t.Polygons[$].anchorPoints;l[wt]=s;var h=Object(c.a)(t.Polygons);h[$].anchorPoints=l,t.UpdatePolygons(h)}},Ut=function(){at(null),St(null)},zt=t.points.concat(G?[]:B).reduce((function(t,e){return t.concat(e)}),[]),Et=function(t,e,n,o){return Math.sqrt(Math.pow(Math.abs(o-e),2)+Math.pow(Math.abs(n-t),2))};window.onkeypress=function(e){100==e.keyCode&&t.Undo()};for(var Ht=i?i.offsetWidth/60:0,It=[],Lt=0;Lt<Ht;Lt++)It.push(Lt);return Object(F.jsx)(l.a,{container:!0,children:Object(F.jsx)(l.a,{item:!0,xs:12,children:Object(F.jsxs)(T.g,{ref:function(n){n&&(e=n,t.ChangeStage(n))},width:i?i.offsetWidth:0,height:i?i.offsetHeight:0,onMouseDown:function(n){!function(t){t.target===t.target.getStage()&&(A(null),gt(null))}(n);var o=e.getPointerPosition(),a=o.x,r=o.y;if("Line"===t.mode&&d({x0:a,y0:r,color:v}),"Polygon"===t.mode){t.stage;var i=Rt();if(function(e){for(var n=0;n<t.Polygons.length;n++){for(var o=0;o<t.Polygons[n].flattenedPoints.length-1;o+=2){if(-10<=e[0]-t.Polygons[n].flattenedPoints[o]&&e[0]-t.Polygons[n].flattenedPoints[o]<=10&&-10<=e[1]-t.Polygons[n].flattenedPoints[o+1]&&e[1]-t.Polygons[n].flattenedPoints[o+1]<=10)return!0;if(e[0]===t.Polygons[n].flattenedPoints[t.Polygons[n].flattenedPoints.length-1][0]&&e[1]===t.Polygons[n].flattenedPoints[t.Polygons[n].flattenedPoints.length-1][1])return!0}for(var a=0;a<t.Polygons[n].anchorPoints.length;a+=1){if(-10<=e[0]-t.Polygons[n].anchorPoints[a][0]&&e[0]-t.Polygons[n].anchorPoints[a][0]<=10&&-10<=e[1]-t.Polygons[n].anchorPoints[a][1]&&e[1]-t.Polygons[n].anchorPoints[a][1]<=10)return!0;if(e[0]===t.Polygons[n].anchorPoints[t.Polygons[n].anchorPoints.length-1][0]&&e[1]===t.Polygons[n].anchorPoints[t.Polygons[n].anchorPoints.length-1][1])return!0}}return!1}(i));else{if(G)return;if(N&&t.points.length>=3){K(!0);var s=[];zt.map((function(t,e){e%2===0&&e<zt.length-3&&(s=[].concat(Object(c.a)(s),[[(zt[e]+zt[e+2])/2,(zt[e+1]+zt[e+3])/2,!1]]))})),t.UpdatePolygons([].concat(Object(c.a)(t.Polygons),[{flattenedPoints:Object(c.a)(zt),points:Object(c.a)(t.points),anchorPoints:Object(c.a)(s),closed:!0}])),t.emptyPoints(),q([0,0]),K(!1),_(!1),t.actionTrigger()}else{var l=i[0],h=i[1];if(t.points.length>0){var u=t.points[t.points.length-1][0],g=t.points[t.points.length-1][1],j=Math.sqrt(Math.pow(l-u,2)+Math.pow(h-g,2)),p=j/(60/t.proportion)*100;i=function(t,e,n,o){var a=[],r=[];if(0==n)a[0]=t[0]+e,a[1]=t[1],r[0]=t[0]-e,r[1]=t[1];else if(n===1/0||n===-1/0)a[0]=t[0],a[1]=t[1]+e,r[0]=t[0],r[1]=t[1]-e;else{var i=e/Math.sqrt(1+n*n),c=n*i;a[0]=t[0]+i,a[1]=t[1]+c,r[0]=t[0]-i,r[1]=t[1]-c}return Math.abs(a[0]-o[0])<Math.abs(r[0]-o[0])?a:r}([u,g],j+(t.accuracy-p%t.accuracy)/100*(60/t.proportion),function(t,e,n,o){return(e-o)/(t-n)}(l,h,u,g),[l,h])}t.AddPoint(i),t.actionTrigger()}}}"Rect"===t.mode&&O({x:a,y:r}),"Circle"===t.mode&&st({x:a,y:r})},onMouseMove:function(){var n=e.getPointerPosition(),o=n.x,a=n.y,r=Rt();if(q(r),"Line"===t.mode&&j)switch(t.mode){case"Line":var i=j.x0,c=j.y0;d(Object(x.a)(Object(x.a)({},j),{},{x0:i,y0:c,x:o,y:a}))}if("Rect"===t.mode&&f){console.log(Ct);var s=f.x,l=f.y,h=Math.abs(o-s),u=Math.abs(a-l);if(o>s)o+=(t.accuracy-h/(60/t.proportion)*100%t.accuracy)*(60/t.proportion)/100;else o-=(t.accuracy-h/(60/t.proportion)*100%t.accuracy)*(60/t.proportion)/100;if(a>l)a+=(t.accuracy-u/(60/t.proportion)*100%t.accuracy)*(60/t.proportion)/100;else a-=(t.accuracy-u/(60/t.proportion)*100%t.accuracy)*(60/t.proportion)/100;O(Object(x.a)(Object(x.a)({},f),{},{width:o>s?o-s:-(s-o),height:a>l?a-l:-(l-a)}))}if("Circle"===t.mode&&ct){var g=ct.x,p=ct.y,b=Et(o,a,g,p)/(60/t.proportion)*100;b=(b+=t.accuracy/2-b%(t.accuracy/2))*(60/t.proportion)/100,st(Object(x.a)(Object(x.a)({},ct),{},{radius:b}))}},onMouseUp:function(){var n=e.getPointerPosition(),o=n.x,a=n.y;if("Line"===t.mode&&(w([].concat(Object(c.a)(k),[{color:j.color,points:[j.x0,j.y0,j.x,j.y],id:"Line"+k.length.toString(),stroke:"black",strokeWidth:2}])),t.actionTrigger(),d(null)),"Rect"===t.mode){var r=f.x,i=f.y,s=Math.abs(o-r),l=Math.abs(a-i);if(o>r)o+=(t.accuracy-s/(60/t.proportion)*100%t.accuracy)*(60/t.proportion)/100;else o-=(t.accuracy-s/(60/t.proportion)*100%t.accuracy)*(60/t.proportion)/100;if(a>i)a+=(t.accuracy-l/(60/t.proportion)*100%t.accuracy)*(60/t.proportion)/100;else a-=(t.accuracy-l/(60/t.proportion)*100%t.accuracy)*(60/t.proportion)/100;Math.abs(r-o)<10&&Math.abs(i-a)<10||t.UpdateRectangles([].concat(Object(c.a)(t.Rectangles),[Object(x.a)(Object(x.a)({},f),{},{x:o>r?r:o,y:a>i?i:a,width:o>r?o-r:r-o,height:a>i?a-i:i-a,id:"Rect"+t.Rectangles.length.toString(),stroke:"black",xDirection:o>r?"right":"left",yDirection:a>i?"up":"down",strokeWidth:2})])),O(null),t.actionTrigger()}if("Circle"===t.mode){var h=ct.x,u=ct.y,g=2*Et(o,a,h,u)/(60/t.proportion)*100;g=(g+=t.accuracy-g%t.accuracy)*(60/t.proportion)/100,Math.abs(h-o)<10&&Math.abs(u-a)<10||(t.UpdateCircles([].concat(Object(c.a)(t.Circles),[Object(x.a)(Object(x.a)({},ct),{},{radius:g,width:2*Et(o,a,h,u),height:2*Et(o,a,h,u),id:"Circle"+t.Circles.length.toString(),stroke:"black",strokeWidth:2})])),t.actionTrigger()),st(null)}},children:[Object(F.jsxs)(T.c,{children:[i?[0,1,2,3,4,5,6,7,8,9,10].map((function(t){return Object(F.jsx)(a.a.Fragment,{children:Object(F.jsx)(T.d,{points:[0,60*t,i.offsetWidth,60*t],strokeWidth:2,stroke:"lightgrey"})})})):Object(F.jsx)(F.Fragment,{}),i?It.map((function(t){return Object(F.jsx)(a.a.Fragment,{children:Object(F.jsx)(T.d,{points:[i.offsetWidth/Ht*t,0,i.offsetWidth/Ht*t,i.offsetHeight],strokeWidth:2,stroke:"lightgrey"})})})):Object(F.jsx)(F.Fragment,{})]}),Object(F.jsxs)(T.c,{children:[Object(F.jsx)(T.d,{id:j?j.id:0,points:j?[j.x0,j.y0,j.x,j.y]:[],strokeWidth:2,stroke:"black"}),k.map((function(t,e){return Object(F.jsx)(T.d,Object(x.a)(Object(x.a)({},t),{},{strokeWidth:2,stroke:"black"}))})),Object(F.jsx)(T.e,Object(x.a)(Object(x.a)({},f),{},{strokeWidth:2,stroke:"black"})),f?Object(F.jsx)(T.h,{text:Math.floor(Math.abs(f.width/2))/Ft,x:f.xDirection=f.x+f.width/2,y:f.y,fontSize:20}):Object(F.jsx)(F.Fragment,{}),f?Object(F.jsx)(T.h,{text:Math.floor(Math.abs(f.height/2))/Ft,x:f.x,y:f.xDirection=f.y+f.height/2,fontSize:20}):Object(F.jsx)(F.Fragment,{}),t.Rectangles.map((function(e,n){return Object(F.jsx)(D,{shapeProps:e,isSelected:e.id===R,onSelect:function(){t.ChangeMode(null),A(e.id)},onChange:function(e){t.Rectangles.slice();t.Rectangles[n]=e,t.UpdateRectangles(t.Rectangles)}},n)})),t.Rectangles.map((function(t,e){return Object(F.jsx)(T.h,{text:Math.floor(Math.abs(t.width/2))/Ft,x:t.xDirection=t.x+t.width/2,y:t.y,fontSize:20})})),t.Rectangles.map((function(t,e){return Object(F.jsx)(T.h,{text:Math.floor(Math.abs(t.height/2))/Ft,x:t.x,y:t.xDirection=t.y+t.height/2,fontSize:20})})),Object(F.jsx)(T.b,Object(x.a)(Object(x.a)({},ct),{},{strokeWidth:2,stroke:"black"})),ct?Object(F.jsx)(T.h,{text:Math.floor(ct.radius)/Ft,x:ct.x,y:ct.y,fontSize:ct.radius<20?15:20}):Object(F.jsx)(F.Fragment,{}),t.Circles.map((function(e,n){return Object(F.jsx)(U,{shapeProps:e,isSelected:e.id===ut,onSelect:function(){t.ChangeMode(null),gt(e.id),A(null)},onChange:function(e){t.Circles.slice();t.Circles[n]=e,t.UpdateCircles(t.Circles)}},n)})),t.Circles.map((function(t,e){return Object(F.jsx)(T.h,{text:Math.floor(t.radius)/Ft/2,x:t.x,y:t.y,fontSize:t.radius<20?15:20})})),Object(F.jsx)(T.d,{points:zt,stroke:"black",strokeWidth:2,closed:G}),t.points.map((function(t,e){var n=t[0]-3,o=t[1]-3,a=0===e?{hitStrokeWidth:12,onMouseOver:At,onMouseOut:Wt}:null;return Object(F.jsx)(T.e,Object(x.a)({x:n,y:o,width:6,height:6,fill:"white",stroke:"black",strokeWidth:3,onDragStart:Tt,onDragMove:Dt,onDragEnd:Ut,draggable:!0},a),e)})),zt.map((function(t,e){var n=-500,o=-500,a=zt[e+2],r=zt[e+3];return e%2===0&&e+3<zt.length&&(n=(t+zt[e+2])/2,o=(zt[e+1]+zt[e+3])/2),e%2===0?Object(F.jsx)(T.h,{text:(parseFloat(Et(n,o,a,r))/Ft).toFixed(2),x:n,y:o,fontSize:20}):Object(F.jsx)(F.Fragment,{})})),t.Polygons.map((function(e,n){return Object(F.jsxs)(F.Fragment,{children:[e.anchorPoints.map((function(t,n){return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(T.f,{sceneFunc:function(o,a){o.beginPath(),e.points[n]&&e.points[n+1]?(o.moveTo(e.points[n][0],e.points[n][1]),o.quadraticCurveTo(t[0],t[1],e.points[n+1][0],e.points[n+1][1])):n===e.points.length-1&&(o.moveTo(e.points[n][0],e.points[n][1]),o.quadraticCurveTo(t[0],t[1],e.points[0][0],e.points[0][1])),o.fillStrokeShape(a)},stroke:"black",strokeWidth:4}),Object(F.jsx)(T.d,{dash:[10,10,0,10],strokeWidth:3,stroke:"red",lineCap:"round",id:"quadLinePath",opacity:.3,points:e.points[n]&&e.points[n+1]?[e.points[n][0],e.points[n][1],t[0],t[1],e.points[n+1][0],e.points[n+1][1]]:[e.points[n][0],e.points[n][1],t[0],t[1],e.points[0][0],e.points[0][1]]}),Object(F.jsx)(T.d,{dash:[10,10,0,10],strokeWidth:3,stroke:"grey",lineCap:"round",id:"quadLinePath",opacity:.3,points:e.points[n]&&e.points[n+1]?[e.points[n][0],e.points[n][1],e.points[n+1][0],e.points[n+1][1]]:[e.points[n][0],e.points[n][1],e.points[0][0],e.points[0][1]]})]})})),e.points.map((function(e,n){var o=e[0]-3,a=e[1]-3,r=0===n?{hitStrokeWidth:12,onMouseOver:At,onMouseOut:Wt}:null;return"Polygon"===t.mode?Object(F.jsx)(T.e,Object(x.a)({x:o,y:a,width:6,height:6,fill:"white",stroke:"#B6D4F8",strokeWidth:3,onDragStart:Tt,onDragMove:Dt,onDragEnd:Ut,draggable:!0},r),n):Object(F.jsx)(F.Fragment,{})})),e.flattenedPoints.map((function(t,n){var o=-500,a=-500,r=e.flattenedPoints[n+2],i=e.flattenedPoints[n+3];return n%2===0&&n+3<e.flattenedPoints.length&&(o=(t+e.flattenedPoints[n+2])/2,a=(e.flattenedPoints[n+1]+e.flattenedPoints[n+3])/2),n%2===0?Object(F.jsx)(T.h,{text:(parseFloat(Et(o,a,r,i))/Ft).toFixed(2),x:o,y:a,fontSize:20}):Object(F.jsx)(F.Fragment,{})})),e.anchorPoints.map((function(e,n){var o=e[0]-3,a=e[1]-3,r=0===n?{hitStrokeWidth:12,onMouseOver:At,onMouseOut:Wt}:null;return"Polygon"===t.mode?Object(F.jsx)(T.e,Object(x.a)({x:o,y:a,width:6,height:6,fill:"white",stroke:"#B6D4F8",strokeWidth:3,onDragStart:Tt,onDragMove:Dt,onDragEnd:Ut,draggable:!0},r),n):Object(F.jsx)(F.Fragment,{})}))]})}))]})]})})})}))),lt=function(t,e,n,o){if(t-n===0)return[1/0,1/0];if(e-o===0)return[0,e];var a=(e-o)/(t-n);return[a,a*(-1*n)+o]},ht=function(t,e){for(var n=0;n<e.length;n++)if(e[n][0]===t[0]&&e[n][1]===t[1])return n;return-1},ut=function(t){for(var e=[],n=[],o=[],a=Object(c.a)(t),r=0;r<t.length;r++)0===r?(e=lt(t[t.length-1][0],t[t.length-1][1],t[r][0],t[r][1]),n=lt(t[r][0],t[r][1],t[r+1][0],t[r+1][1])):r===t.length-1?(e=lt(t[r-1][0],t[r-1][1],t[r][0],t[r][1]),n=lt(t[r][0],t[r][1],t[0][0],t[0][1])):(e=lt(t[r-1][0],t[r-1][1],t[r][0],t[r][1]),n=lt(t[r][0],t[r][1],t[r+1][0],t[r+1][1])),e[0]===n[0]&&o.push(r);o=Object(c.a)(new Set(o));for(var i=0;i<o.length;i++)a.splice(o[i]-i,1);return a},gt=function(t,e,n){console.log(t,e,n,"shapeSplitterCords");for(var o=ht(t,n),a=ht(e,n),r=[],i=[],s=(lt(n[a][0],n[a][1],n[o][0],n[o][1]),o);s<=a;s++)r=[].concat(Object(c.a)(r),[n[s]]);for(var l=a;l<n.length;l++)i=[].concat(Object(c.a)(i),[n[l]]);for(var h=0;h<=o;h++)i=[].concat(Object(c.a)(i),[n[h]]);return console.log(ut(r),ut(i),"splitted Shapes"),[ut(r),ut(i)]},jt=(n(285),n(97)),dt=(n(153),n(35)),pt=n(96),bt=(n(99),n(123),n(100)),xt=(n(124),n(154),function(t){for(var e=[],n=0;n<t.length;n++)e=[].concat(Object(c.a)(e),[jt.point([t[n][0],t[n][1]])]);return e=jt.featureCollection(e)}),ft=function(t){var e=xt(t),n=(Object(pt.default)(e),Object(dt.coordAll)(e));Number.MAX_SAFE_INTEGER;return Object(bt.default)(xt(n))},Ot=function(t,e,n,o){var a=(e-o)/(t-n);return[a,a*(-1*n)+o]},yt=function(t,e,n){var o,a,r=Ot(t[0],t[1],e[0],e[1]);if(Math.abs(r[0])===1/0&&Math.abs(n[0][0])===1/0)return t[0],n[1][0],!1;if(r[0]===1/0||r[0]===-1/0){if(a=n[1][1],o=t[0],0===Math.abs(n[0][0]))return Math.min(n[1][0],n[1][2])<t[0]&&Math.max(n[1][0],n[1][2])>t[0]&&n[1][1]<Math.max(t[1],e[1])&&n[1][1]>Math.min(t[1],e[1])}else{if(n[0][0]!==1/0&&n[0][0]!==-1/0){o=(r[1]-n[0][1])/(n[0][0]-r[0]),a=r[0]*o+r[1],o=parseFloat(o.toFixed(2)),a=parseFloat(a.toFixed(2));var i=parseFloat(Math.max(n[1][0],n[1][2]).toFixed(2)),c=parseFloat(Math.max(n[1][1],n[1][3]).toFixed(2)),s=parseFloat(Math.max(t[0],e[0]).toFixed(2)),l=parseFloat(Math.max(t[1],e[1]).toFixed(2)),h=parseFloat(Math.min(n[1][0],n[1][2]).toFixed(2)),u=parseFloat(Math.min(n[1][1],n[1][3]).toFixed(2)),g=parseFloat(Math.min(t[0],e[0]).toFixed(2)),j=parseFloat(Math.min(t[1],e[1]).toFixed(2));return o<=s&&o<i&&o>=g&&o>h&&a<=l&&a<c&&a>=j&&a>u}a=t[1],o=n[1][0]}o=parseFloat(o.toFixed(2)),a=parseFloat(a.toFixed(2));var d=parseFloat(Math.max(n[1][0],n[1][2]).toFixed(2)),p=parseFloat(Math.max(n[1][1],n[1][3]).toFixed(2)),b=parseFloat(Math.max(t[0],e[0]).toFixed(2)),x=parseFloat(Math.max(t[1],e[1]).toFixed(2)),f=parseFloat(Math.min(n[1][0],n[1][2]).toFixed(2)),O=parseFloat(Math.min(n[1][1],n[1][3]).toFixed(2)),y=parseFloat(Math.min(t[0],e[0]).toFixed(2)),m=parseFloat(Math.min(t[1],e[1]).toFixed(2));return o<=b&&o<=d&&o>=y&&o>=f&&a<=x&&a<=p&&a>=m&&a>=O},mt=function(t,e,n,o){for(var a=0,r=0;r<n.length;r++)yt(t,e,n[r])&&a++;return!(a>=2)&&!!vt((t[0]+e[0])/2,(t[1]+e[1])/2,o)},vt=function(t,e,n){for(var o=n[0],a=[],r=0,i=1;i<=n.length;i++){if(a=n[i%n.length],e>Math.min(o[1],a[1])&&e<=Math.max(o[1],a[1])&&t<=Math.max(o[0],a[0])&&o[1]!=a[1]){var c=(e-o[1])*(a[0]-o[0])/(a[1]-o[1])+o[0];(o[0]==a[0]||t<=c)&&r++}o=a}return r%2!=0},Pt=function(t,e){for(var n=0;n<e.length;n++)if(e[n][0]===t[0]&&e[n][1]===t[1])return n;return-1},Mt=function(t,e,n,o,a){return n[0]===1/0||n[0]===-1/0?Math.abs(t-o[0]):-0===n[0]||0===n[0]?Math.abs(e-o[1]):Math.sqrt(Math.pow(t-a[0],2)+Math.pow(e-a[1],2))},kt=function(t,e,n,o){var a=0;return e[0]===1/0||e[0]===-1/0?[a=o[0],n[1]]:0===e[0]||-0===e[0]?[a=n[0],o[1]]:[a=(e[1]-t[1])/(t[0]-e[0]),t[0]*a+t[1]]},wt=function(t,e){for(var n=[],o=[],a=[],r=0;r<e.length;r++){if(e[r][0][0]!==1/0){if(-0!==e[r][0][0]||0!==e[r][0][0]){var i=-1/e[r][0][0];o=[i,t[1]-i*t[0]]}else o=[1/0,NaN];(a=o[0]===1/0?[t[0],e[r][1][1]]:kt(o,e[r][0],t,e[r][1]))[1]>Math.min(e[r][1][1],e[r][1][3])&&a[1]<Math.max(e[r][1][1],e[r][1][3])&&a[0]>Math.min(e[r][1][0],e[r][1][2])&&a[0]<Math.max(e[r][1][0],e[r][1][2])&&n.push(e[r]),o[0]===1/0&&a[0]>Math.min(e[r][1][0],e[r][1][2])&&a[0]<Math.max(e[r][1][0],e[r][1][2])&&n.push(e[r])}e[r][0][0]===1/0&&t[1]>Math.min(e[r][1][1],e[r][1][3])&&t[1]<Math.max(e[r][1][1],e[r][1][3])&&n.push(e[r])}return n},St=function(t){for(var e=1e3,n=[],o=function(t){for(var e=[],n=0;n<t.length-1;n++){var o=Ot(t[n][0],t[n][1],t[n+1][0],t[n+1][1]);e=o[0]===1/0||o[0]===-1/0?[].concat(Object(c.a)(e),[[[1/0,t[n+1][0]],[t[n][0],t[n][1],t[n+1][0],t[n+1][1]]]]):[].concat(Object(c.a)(e),[[Ot(t[n][0],t[n][1],t[n+1][0],t[n+1][1]),[t[n][0],t[n][1],t[n+1][0],t[n+1][1]]]])}return[].concat(Object(c.a)(e),[[Ot(t[t.length-1][0],t[t.length-1][1],t[0][0],t[0][1]),[t[t.length-1][0],t[t.length-1][1],t[0][0],t[0][1]]]])}(t),a=0;a<t.length;a++)for(var r=wt(t[a],o),i=0;i<r.length;i++){var s=-1/r[i][0][0],l=kt([s,t[a][1]-s*t[a][0]],r[i][0],t[a],r[i][1]);if(mt([t[a][0],t[a][1]],l,o,t)&&Mt(t[a][0],t[a][1],r[i][0],r[i][1],l)<e){e=Mt(t[a][0],t[a][1],r[i][0],r[i][1],l);var h=[];h.push(s);var u=t[a][1]-s*t[a][0];h.push(u),n=[t[a][0],t[a][1],kt(h,r[i][0],t[a],r[i][1]),Pt([r[i][1][0],r[i][1][1]],t)+1]}}return n},Ct=function(t,e){console.log(t,e,"measures");var n=[0,0,0],o=100,a=0,r=0,i=[];if(e<2)return n[0]=1,[n,o=2-e];if(e>2&&e<=3)return n[1]=1,[n,o=3-e];if(e>3&&e<=4)return n[2]=1,[n,o=4-e];for(var s=2;s<=4;s++){n[s-2]=Math.floor(e/s)-1,s-(a=s+e%s)%s,r=s;for(var l=2;l<=4;l++)a!==s&&l>=a&&Math.abs(l-a)<Math.abs(r-a)&&(r=l,Math.abs(l-a));n[r-2]+=1,a>r&&(n[r-2]+=1),Math.abs(e-(2*n[0]+3*n[1]+4*n[2]))<o&&(o=Math.abs(e-(2*n[0]+3*n[1]+4*n[2])),i=Object(c.a)(n)),n=[0,0,0]}return[i=function(t){var e=[0,0,0],n=t[0],o=t[1];n=t[0]%2,o=t[1]%4;var a=(t[0]-n)/2;return a+=(t[1]-o)/4,a+=t[2],e[0]=n,e[1]=o,e[2]=a,e}(i),o]},Ft=function(t,e,n,o){return Math.sqrt(Math.pow(t-n,2)+Math.pow(e-o,2))},Rt=function(t){var e,n;return Math.abs(t[0][0]-t[1][0])<=Math.abs(t[0][1]-t[1][1])?(e=Ft(t[0][0],t[0][1],t[1][0],t[1][1]),n=Ft(t[1][0],t[1][1],t[2][0],t[2][1])):(e=Ft(t[1][0],t[1][1],t[2][0],t[2][1]),n=Ft(t[0][0],t[0][1],t[1][0],t[1][1])),e%1>0&&e%1<.05&&(e=Math.floor(e)),n%1<0&&n%1<.05&&(n=Math.floor(n)),[e,n]},At=function(t,e,n){for(var o=[],a=0;a<e.length;a++)a===n&&o.push(t),o.push(e[a]);return n===e.length&&o.push(t),o},Wt=function(t,e){for(var n=0,o=0,a=0;a<t.length;a++)for(var r=0;r<t[a].length;r++)n+=t[a][r][1],o+=e[a][r][1];return n<=o?"horizontal":"vertical"},Tt=function(t,e){for(var n=0;n<e.length;n++)if(e[n][0]===t[0]&&e[n][1]===t[1])return n;return-1},Dt=function(t){for(var e=0,n=0,o=t.length;n<o;n++){e+=t[n][0]*t[n==t.length-1?0:n+1][1]*.5,e-=t[n==t.length-1?0:n+1][0]*t[n][1]*.5}return Math.abs(e)},Ut=function(t,e,n){for(var o=[],a=[t],r=[],i=0;a.length>0;){for(var s=0;s<a.length;s++)if(a[s].length<=4)o.push(a[s]);else if(0===(i=St(a[s])).length)o.push(a[s]);else{a[s]=At(i[2],a[s],i[3]);var l=void 0;(l=Tt([i[0],i[1]],a[s])<Tt(i[2],a[s])?gt([i[0],i[1]],i[2],a[s]):gt(i[2],[i[0],i[1]],a[s]))[0].length<=4?o.push(l[0]):r.push(l[0]),l[1].length<=4?o.push(l[1]):r.push(l[1])}a=Object(c.a)(r),r=[]}o.length>=5&&(o=[t]);for(var h=[],u=0;u<o.length;u++){var g=ft(o[u]),j=Rt(g.geometry.coordinates[0]),d=Ct(j[0],j[1]),p=Ct(j[1],j[0]);console.log(j,"Measures");var b=zt(Object(c.a)(j));if(console.log(b,"Measures2"),"minimumWaste"===e&&(d[1]*b[0]<p[1]*b[1]||d[1]*b[0]===p[1]*b[1]&&b[1]<=b[0]?(d.push(j[0]),h.push(d)):(p.push(j[1]),h.push(p))),"minimumAttachments"===e){var x=d[0][0]+d[0][1]+d[0][2],f=p[0][0]+p[0][1]+p[0][2];x<f?(d.push(j[0]),h.push(d)):x>f||d[1]>p[1]?(p.push(j[1]),h.push(p)):(d.push(j[0]),h.push(d))}"sameDirection"===e&&("up"===n?(d.push(j[0]),h.push(d)):(p.push(j[1]),h.push(p)));var O=Dt(o[u]),y=Dt(g.geometry.coordinates[0]),m=h[u][1],v=h[u][2]===j[0]?j[1]:j[0];h[u][1]=y-O+h[u][1]*Et(h[u][2])+v*(Et(h[u][2])-h[u][2]),h[u].push(Ht(g.geometry.coordinates[0])),h[u].push(o[u]),h[u].push(m),h[u].push(Et(h[u][2])===j[0]?"down":"right"),h[u].push(Et(h[u][2]))}return h},zt=function(t){var e=[];return t[0]%1<.5&&t[0]%1>0?t[0]+=.5-t[0]%1:t[0]%1>.5&&(t[0]+=1-t[0]%1),e.push(t[0]),t[1]%1<.5&&t[1]%1>0?t[1]+=.5-t[1]%1:t[1]%1>.5&&(t[1]+=1-t[1]%1),e.push(t[1]),e},Et=function(t){return t%1<.5&&t%1>0?t+=.5-t%1:t%1>.5&&(t+=1-t%1),t},Ht=function(t){for(var e=[],n=t.length-2;n>=0;n--)e.push(t[n]);return e},It=function(t){for(var e=[],n=[],o=[],a=[],r=[],i=0;i<t.length;i++)n.push(Ut(t[i],"minimumWaste"));e.push(n);for(var c=0;c<t.length;c++)o.push(Ut(t[c],"minimumAttachments"));e.push(o);for(var s=0;s<t.length;s++)a.push(Ut(t[s],"sameDirection","up")),r.push(Ut(t[s],"sameDirection","left"));var l=Wt(r,a);return"horizontal"===l?e.push(r):e.push(a),"horizontal"===(l=function(t,e){for(var n=0,o=0,a=0;a<t.length;a++)for(var r=0;r<t[a].length;r++)n+=t[a][r][0][0]+t[a][r][0][1]+t[a][r][0][2],o+=e[a][r][0][0]+e[a][r][0][1]+e[a][r][0][2];return n<o?"horizontal":n>o?"vertical":Wt(t,e)}(r,a))?e.push(r):e.push(a),e},Lt=function(t){for(var e=Object(c.a)(t),n=0;n<e.length;n++)for(var o=e[n][0],a=e[n][1],r=0;r<e.length;r++)o-e[r][0]>0&&o-e[r][0]<20&&(e[r][0]=o),a-e[r][1]>0&&a-e[r][1]<20&&(e[r][1]=a);return e},Bt=function(t,e,n){for(var o=[],a=0;a<t.length;a++){var r=[t[a][0]/e,(n-t[a][1])/e];o.push(r)}return o},qt=function(t,e,n,o){return[[t,e+n],[t,e],[t+o,e],[t+o,e+n]]},Xt={TransformintoProportion:Bt,FindRectPoints:qt,RectangleHandler:function(t,e,n){for(var o=[],a=0;a<t.length;a++){var r=qt(t[a].x,t[a].y,t[a].height,t[a].width);r=Bt(r,n,e),o.push(r)}return o},PolygonHandler:function(t,e,n){for(var o=[],a=0;a<t.length;a++){var r=t[a].points;r=Lt(r),r=Bt(r,n,e),o.push(r)}return o},CircleHandler:function(t,e,n){for(var o=[],a=0;a<t.length;a++){var r=t[a].x,i=t[a].y,c=t[a].radius,s=qt(r-c/2,i-c/2,c,c);s=Bt(s,n,e),o.push(s)}return o}},Yt=Object(W.b)((function(t){return{mode:t.konva.mode,stage:t.konva.stage,height:t.konva.height,Polygons:t.konva.Polygons,Rectangles:t.konva.Rectangles,Circles:t.konva.Circles,proportion:t.konva.proportion}}),(function(t){return{ChagneResultArray:function(e){return t({type:"ChagneResultArray",newResult:e})}}}))((function(t){var e=Object(o.useState)(!1),n=Object(s.a)(e,2),a=n[0],r=n[1];return Object(F.jsxs)(l.a,{container:!0,spacing:0,style:{direction:"rtl"},children:[Object(F.jsxs)(l.a,{item:!0,xl:12,xs:12,children:[Object(F.jsx)("p",{style:{direction:"rtl",fontSize:"24px",marginRight:"20px"},children:"\u05de\u05d7\u05e9\u05d1\u05d5\u05df \u05d3\u05e9\u05d0 \u05e1\u05d9\u05e0\u05d8\u05d8\u05d9"}),Object(F.jsx)(h.a,{variant:"middle",style:{width:"15%",position:"absolute",right:"0",marginTop:"-20px"}})]}),Object(F.jsx)(l.a,{item:!0,xl:1.5,xs:1.5,children:Object(F.jsxs)(u.a,{style:{width:"100%",marginRight:"20px"},children:[Object(F.jsx)(j.a,{expandIcon:Object(F.jsx)(p.a,{}),children:"\u05d4\u05d5\u05e8\u05d0\u05d5\u05ea"}),Object(F.jsx)(g.a,{children:"yay"})]})}),Object(F.jsx)(l.a,{item:!0,xl:12,xs:12}),Object(F.jsx)(l.a,{item:!0,xl:1,md:2,xs:3,style:{marginTop:"15px",marginRight:"15px"},children:Object(F.jsx)(b.a,{onClick:function(){var e,n=Xt.RectangleHandler(t.Rectangles,t.height,30/t.proportion*2),o=Xt.PolygonHandler(t.Polygons,t.height,30/t.proportion*2),a=Xt.CircleHandler(t.Circles,t.height,30/t.proportion*2);try{e=It([].concat(Object(c.a)(n),Object(c.a)(a),Object(c.a)(o)))}catch(i){alert("cant handle it yet")}console.log(e),t.ChagneResultArray(e),r(!0)},variant:"extended",style:{width:"100%",color:"black",backgroundColor:"#AFD5AA"},children:Object(F.jsx)("p",{style:{color:"white"},children:"\u05d7\u05e9\u05d1"})})}),Object(F.jsx)(l.a,{xl:11,xs:11,children:Object(F.jsxs)("div",{style:{border:"2px solid grey",borderRadius:"5px",height:"68vh",width:"97vw",marginRight:"20px",marginTop:"20px"},children:[Object(F.jsx)("div",{style:{height:"13%"},children:Object(F.jsx)(nt,{})}),Object(F.jsx)("div",{id:"parent",style:{height:"83%",width:"97vw",marginTop:"20px"},children:Object(F.jsx)(st,{})})]})}),Object(F.jsx)(l.a,{xl:12,xs:12,style:{height:"90%",width:"90%"},children:Object(F.jsx)(L,{open:a,close:function(){r(!1)}})})]})}));var Nt=function(){return Object(F.jsx)(Yt,{})},_t=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,366)).then((function(e){var n=e.getCLS,o=e.getFID,a=e.getFCP,r=e.getLCP,i=e.getTTFB;n(t),o(t),a(t),r(t),i(t)}))},Vt=n(101),Jt={mode:"Polygon",stage:null,height:0,Polygons:[],Rectangles:[],Circles:[],Windowstage:null,AlgorithmResult:[],points:[],proportion:1,accuracy:10,stateStack:[]},Gt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Jt,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"ChangeMode":return Object(x.a)(Object(x.a)({},t),{},{mode:e.newMode});case"ChangeStage":return Object(x.a)(Object(x.a)({},t),{},{stage:e.newStage});case"ChangeStageWindow":return Object(x.a)(Object(x.a)({},t),{},{Windowstage:e.newWindowstage});case"UpdatePolygons":return Object(x.a)(Object(x.a)({},t),{},{Polygons:e.newPolygons});case"UpdateRectangles":return Object(x.a)(Object(x.a)({},t),{},{Rectangles:e.newRectangles});case"UpdateCircles":return Object(x.a)(Object(x.a)({},t),{},{Circles:e.newCircles});case"ChagneResultArray":return Object(x.a)(Object(x.a)({},t),{},{AlgorithmResult:e.newResult});case"AddPoint":var n=[].concat(Object(c.a)(t.points),[e.newPoint]);return Object(x.a)(Object(x.a)({},t),{},{points:n});case"emptyPoints":return Object(x.a)(Object(x.a)({},t),{},{points:[]});case"actionTrigger":var o=Object(x.a)({},t);delete o.stateStack;var a=[].concat(Object(c.a)(t.stateStack),[o]);return Object(x.a)(Object(x.a)({},t),{},{stateStack:a});case"Undo":var r;return t.stateStack.length<=1?r={mode:"Polygon",stage:null,height:0,Polygons:[],Rectangles:[],Circles:[],Windowstage:null,AlgorithmResult:[],points:[],proportion:1,accuracy:10,stateStack:[]}:((r=Object(x.a)({},t.stateStack[t.stateStack.length-2])).stateStack=t.stateStack,r.stateStack.splice(r.stateStack.length-1,1)),console.log(r,"laststate"),Object(x.a)({},r);case"Reset":return{mode:"Polygon",stage:null,height:0,Polygons:[],Rectangles:[],Circles:[],Windowstage:null,AlgorithmResult:[],points:[],proportion:1,accuracy:10,stateStack:[]};case"ChangeProportion":return Object(x.a)(Object(x.a)({},t),{},{proportion:e.newProportion});case"ChangeAccuracy":return Object(x.a)(Object(x.a)({},t),{},{accuracy:e.newAccuracy})}return t},Kt=Object(Vt.a)({konva:Gt}),Qt=Object(Vt.b)(Kt);i.a.render(Object(F.jsx)(W.a,{store:Qt,children:Object(F.jsx)(a.a.StrictMode,{children:Object(F.jsx)(Nt,{})})}),document.getElementById("root")),_t()}},[[292,1,2]]]);
//# sourceMappingURL=main.cee573cc.chunk.js.map